<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC
 "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
 "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">

<hibernate-mapping>
    <class name="model.Person" table="person">
        <id name="dni" column="dni" type="int">
            <generator class="assigned"/>
        </id>

        <property name="lastName" column="lastName" type="string" not-null="true"/>
        <property name="firstName"   column="firstName"   type="string" not-null="true"/>
        <property name="birthDate" column="birthDate" type="date"/>

        <many-to-one name="city" class="model.City" column="idCity"  lazy="proxy" not-null="true" cascade="save-update"/>

    
        <joined-subclass name="model.Student" table="student">
            <key column="dni"/>

            <property name="studentNumber"   column="studentNumber"   type="int"  not-null="true" unique="true"/>
            <property name="enrollmentYear" column="enrollmentYear" type="int"   not-null="true"/>

            <set name="subjects" table="subject_student" lazy="true">
                <key column="dniStudent"/>
                <many-to-many class="model.Subject" column="idSubject"/>
            </set>
        </joined-subclass>


        <joined-subclass name="model.Professor" table="professor">
            <key column="dni"/>
            <property name="seniority" type="int"/>
        </joined-subclass>
    </class>

    <class name="model.City" table="city">
        <id name="idCity" column="idCity" type="int" >
            <generator class="identity"/>
        </id>
        <property name="name" column="name" type="string" not-null="true"/>
    </class>

    <class name="model.Faculty" table="faculty">
        <id name="idFaculty" column="idFaculty" type="int">
            <generator class="identity"/>
        </id>
        <property name="name" column="name" type="string" not-null="true"/>
        <many-to-one name="city" class="model.City" column="idCity" not-null="true"  cascade="save-update"/>
    </class>

    <class name="model.Career" table="career">
        <id name="idCareer" column="idCareer" type="int">
            <generator class="identity"/>
        </id>
        <property name="name" column="name" type="string" not-null="true"/>

    
        <many-to-one name="faculty" class="model.Faculty" column="idFaculty" not-null="true" cascade="save-update"/>

    
        <list name="subjects" inverse="true" lazy="true" cascade="all-delete-orphan">
            <key column="idCareer"/>
            <index column="orderNumber"/>
            <one-to-many class="model.Subject"/>
        </list>
    </class>

  
    <class name="model.Subject" table="subject">
        <id name="idSubject" column="idSubject" type="int">
            <generator class="identity"/>
        </id>
        <property name="name" column="name" type="string" not-null="true"/>
        <property name="level"  column="level"  type="int" not-null="true"/>
        <property name="order"  column="orderNumber"  type="int"/>

        <many-to-one name="professor" class="model.Professor" column="dniProfessor" lazy="proxy"/>
        <many-to-one name="career"  class="model.Career"  column="idCareer" not-null="true" lazy="proxy"/>

    
        <set name="students" table="subject_student" inverse="true" lazy="true">
            <key column="idSubject"/>
            <many-to-many class="model.Student" column="dniStudent"/>
        </set>

    </class>

</hibernate-mapping>


